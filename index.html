<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>B·∫£ng t·ª∑ gi√° BIDV - Chi nh√°nh Th√†nh Vinh</title>
<link rel="icon" href="images/favicon.ico" type="image/x-icon"> 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: 'Inter', Arial, sans-serif;
    background: #003D3C;
    color: white;
}

/* ===== HEADER ===== */
.header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 30px;
}

.logo {
    background: white;
    padding: 8px 14px;
    border-radius: 8px;
}
.logo img {
    height: 48px;
    display: block;
}

.center-title {
    font-size: 38px;
    font-weight: 800;
    letter-spacing: 1.5px;
    margin-left: 50px;
    color: #F7C227;
}

.datetime {
    font-size: 20px;
    font-weight: 600;
    white-space: nowrap;
}
.divider {
    color: #FFD966;
    margin: 0 8px;
}
.clock {
    color: #FFD966;
    margin-right: 4px;
}

/* GOLD LINE */
.gold-line {
    height: 6px;
    background: #F7C227;
}

/* ===== CONTENT ===== */
.content {
    background: #FFFFFF;
    color: #000;
    margin: 25px auto;
    width: 95%;
    max-width: 1300px;
    padding-bottom: 30px;
    border-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

.sub-title {
    text-align: center;
    font-size: 28px;
    font-weight: 800;
    padding: 20px 0 15px;
    color: #004787;
    border-bottom: 2px solid #EEEEEE;
    margin: 0 30px;
}

.last-update {
    text-align: center;
    font-size: 16px;
    color: #555;
    padding: 10px 0;
    font-style: italic;
}

/* TABLE */
table {
    width: 95%;
    margin: 20px auto 0;
    border-collapse: collapse;
    font-size: 20px;
    border: 3px solid #004787;
    border-radius: 16px;
    overflow: hidden;
}

th {
    background: #004787;
    color: white;
    padding: 14px;
    font-weight: 700;
    text-transform: uppercase;
}

td {
    padding: 14px;
    border-bottom: 1px solid #E0E0E0;
    font-weight: 600;
}

/* C·ªôt Lo·∫°i ti·ªÅn */
td:nth-child(1) {
    text-align: left;
    font-weight: 700;
    color: #333;
}

/* C·ªôt T√™n ngo·∫°i t·ªá */
td:nth-child(2) {
    text-align: left;
    color: #333;
}

/* C√°c c·ªôt s·ªë */
td:nth-child(n+3) {
    text-align: center;
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.5px;
}

/* D√≤ng xen k·∫Ω */
tr:nth-child(even) td {
    background: #F4F8FB;
}

/* FOOTER */
.footer {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    background: #003D3C;
    text-align: center;
    padding: 18px 20px;
    font-size: 18px;
    font-weight: 600;
    box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
}

.footer-gold {
    color: #FFD966;
    font-style: italic;
}

/* ===== RESPONSIVE CSS (Cho ƒêi·ªán tho·∫°i) ===== */
@media (max-width: 768px) {
    .header {
        flex-direction: column;
        padding: 15px 20px;
        align-items: center;
    }
    .center-title {
        font-size: 24px;
        margin: 10px 0;
        text-align: center;
        letter-spacing: 1px;
    }
    .datetime {
        font-size: 16px;
        margin-top: 5px;
    }
    
    .content {
        width: 98%;
        margin: 15px auto;
        padding-bottom: 20px;
    }
    
    .sub-title {
        font-size: 20px;
        padding: 15px 0 10px;
    }
    
    table {
        font-size: 14px;
        width: 98%;
    }
    
    th, td {
        padding: 10px 6px; /* Gi·∫£m padding cho √¥ */
    }

    /* Thu h·∫πp c·ªôt Lo·∫°i ti·ªÅn v√† T√™n ngo·∫°i t·ªá */
    td:nth-child(1), th:nth-child(1) { width: 10%; }
    td:nth-child(2), th:nth-child(2) { width: 30%; }
    
    .footer {
        font-size: 14px;
        padding: 15px 10px;
    }
}
/* END RESPONSIVE CSS */
</style>
</head>

<body>

<div class="header">
    <div class="logo">
        <img src="images/logo.png" alt="BIDV">
    </div>

    <div class="center-title">
        NG√ÇN H√ÄNG BIDV CHI NH√ÅNH TH√ÄNH VINH
    </div>

    <div class="datetime">
        <span id="date"></span>
        <span class="divider">|</span>
        <span class="clock">üïí</span>
        <span id="clock"></span>
    </div>
</div>

<div class="gold-line"></div>

<div class="content">
    <div class="sub-title">B·∫¢NG T·ª∂ GI√Å NGO·∫†I T·ªÜ</div>

    <div class="last-update">
        L·∫ßn c·∫≠p nh·∫≠t cu·ªëi:
        <span id="last-update-time"></span>
    </div>

    <table>
        <thead>
            <tr>
                <th>Lo·∫°i ti·ªÅn</th>
                <th>T√™n ngo·∫°i t·ªá</th>
                <th>Mua ti·ªÅn m·∫∑t</th>
                <th>Mua chuy·ªÉn kho·∫£n</th>
                <th>B√°n</th>
            </tr>
        </thead>
        <tbody id="exchange-rate-data">
            <tr><td colspan="5" style="text-align: center; font-style: italic;">ƒêang t·∫£i d·ªØ li·ªáu t·ª∑ gi√°...</td></tr>
        </tbody>
    </table>
</div>

<div class="footer">
    NG√ÇN H√ÄNG TMCP ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN VI·ªÜT NAM ‚Äì CHI NH√ÅNH TH√ÄNH VINH
    <span class="footer-gold"> ‚Äì H√ÇN H·∫†NH PH·ª§C V·ª§ QU√ù KH√ÅCH</span>
</div>

<script>
// =======================================================
// ** THI·∫æT L·∫¨P K·∫æT N·ªêI GOOGLE SHEET (D√πng ph∆∞∆°ng ph√°p API CSV) **
// =======================================================
// ID Google Sheet ƒê√É ƒê∆Ø·ª¢C S·ª¨A CH·ªÆA theo ƒë∆∞·ªùng link m·ªõi c·ªßa √îng Ch·ªß
const SHEET_ID = '16NdPp2DlDjJRjHSsdhPOig4_c3mq7CbfRfBf2gcl5I8'; 
// T√™n Sheet m·ªõi c·ªßa √îng Ch·ªß
const SHEET_NAME = 'data'; 
// D√πng API CSV ƒë·ªÉ tr√°nh l·ªói metadata c·ªßa Gviz
const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;

// H√†m c·∫≠p nh·∫≠t th·ªùi gian hi·ªÉn th·ªã
function updateTime() {
    const now = new Date();
    const dateOptions = { weekday: 'long', day: '2-digit', month: '2-digit', year: 'numeric' };
    document.getElementById("date").innerHTML = now.toLocaleDateString('vi-VN', dateOptions);
    document.getElementById("clock").innerHTML = now.toLocaleTimeString('vi-VN');
}

// ** H√ÄM ƒê·ªäNH D·∫†NG ƒê√É ƒê∆Ø·ª¢C C·∫¨P NH·∫¨T ƒê·ªÇ X·ª¨ L√ù D·∫§U PH·∫®Y TH·∫¨P PH√ÇN **
function formatValue(value) {
    if (!value || value === '-') {
        return value || ''; // Tr·∫£ v·ªÅ d·∫•u g·∫°ch ngang ho·∫∑c chu·ªói r·ªóng
    }
    
    // 1. X√≥a d·∫•u nh√°y k√©p (n·∫øu c√≥) v√† kho·∫£ng tr·∫Øng
    let cleanedValue = value.replace(/"/g, '').trim(); 
    
    // 2. Ki·ªÉm tra n·∫øu gi√° tr·ªã l√† s·ªë
    let isNumeric = !isNaN(cleanedValue.replace(',', '.')); 
    
    if (isNumeric && cleanedValue !== '') {
        // Thay d·∫•u ph·∫©y (decimal separator) th√†nh d·∫•u ch·∫•m tr∆∞·ªõc khi parse
        const parseableValue = cleanedValue.replace(/,/g, '.'); 
        const numberValue = parseFloat(parseableValue);

        if (!isNaN(numberValue)) {
            // ƒê·ªãnh d·∫°ng l·∫°i theo ƒë·ªãnh d·∫°ng Vi·ªát Nam (d·∫•u ch·∫•m l√† ng√†n, d·∫•u ph·∫©y l√† th·∫≠p ph√¢n)
            return numberValue.toLocaleString('vi-VN', { minimumFractionDigits: 0, maximumFractionDigits: 4 }); 
        }
    }
    
    // 3. N·∫øu kh√¥ng ph·∫£i s·ªë (v√≠ d·ª•: m√£ ti·ªÅn t·ªá, t√™n, ho·∫∑c d·∫•u g·∫°ch ngang)
    return cleanedValue;
}

// H√†m l·∫•y d·ªØ li·ªáu t·ª´ Google Sheets (D√πng XMLHttpRequest)
function fetchExchangeRates() {
    const tableBody = document.getElementById('exchange-rate-data');
    
    const xhr = new XMLHttpRequest();
    xhr.open('GET', API_URL);
    xhr.onload = function() {
        if (xhr.status === 200) {
            const csvData = xhr.responseText;
            const rows = csvData.split('\n');
            let newRows = '';

            // B·ªè qua H√†ng 1 (Ti√™u ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c ƒë·ªïi th√†nh Ti·∫øng Anh)
            for (let i = 1; i < rows.length; i++) {
                // S·ª¨ D·ª§NG D·∫§U PH·∫®Y (,) L√ÄM D·∫§U PH√ÇN C√ÅCH (DELIMITER)
                const cells = rows[i].split(','); 
                
                // Ki·ªÉm tra ƒë·ªß 5 c·ªôt d·ªØ li·ªáu kh√¥ng
                if (cells.length < 5) continue; 
                
                // L·∫•y d·ªØ li·ªáu v√† ƒë·ªãnh d·∫°ng
                const currencyCode = formatValue(cells[0].trim());
                const currencyName = formatValue(cells[1].trim());
                const cashBuy = formatValue(cells[2].trim());
                const transferBuy = formatValue(cells[3].trim());
                const sell = formatValue(cells[4].trim());

                if (currencyCode) { // Ch·ªâ th√™m d√≤ng n·∫øu c√≥ Lo·∫°i ti·ªÅn
                     newRows += `
                        <tr>
                            <td>${currencyCode}</td>
                            <td>${currencyName}</td>
                            <td>${cashBuy}</td>
                            <td>${transferBuy}</td>
                            <td>${sell}</td>
                        </tr>`;
                }
            }

            if (newRows) {
                tableBody.innerHTML = newRows;
                // C·∫≠p nh·∫≠t "L·∫ßn c·∫≠p nh·∫≠t cu·ªëi"
                const now = new Date();
                document.getElementById("last-update-time").innerHTML = 
                    now.toLocaleTimeString('vi-VN') + ' - ' + now.toLocaleDateString('vi-VN');
            } else {
                 tableBody.innerHTML = 
                    '<tr><td colspan="5" style="text-align: center; color: red; font-weight: bold;">Kh√¥ng c√≥ d·ªØ li·ªáu t·ª∑ gi√° n√†o ƒë∆∞·ª£c t·∫£i. Vui l√≤ng ki·ªÉm tra Sheet "data".</td></tr>';
            }

        } else {
            console.error('L·ªói khi t·∫£i t·ª∑ gi√°:', xhr.status);
            tableBody.innerHTML = 
                '<tr><td colspan="5" style="text-align: center; color: red; font-weight: bold;">L·ªói k·∫øt n·ªëi API. Vui l√≤ng ki·ªÉm tra ID v√† T√™n Sheet.</td></tr>';
        }
    };
    xhr.send();
}


// --- Kh·ªüi t·∫°o ---
setInterval(updateTime, 1000); 
updateTime(); 
fetchExchangeRates(); 
setInterval(fetchExchangeRates, 300000); 
</script>

</body>
</html>
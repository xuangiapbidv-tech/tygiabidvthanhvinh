<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>B·∫£ng t·ª∑ gi√° BIDV - Chi nh√°nh Th√†nh Vinh</title>
<link rel="icon" href="images/favicon.ico" type="image/x-icon"> 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: 'Inter', Arial, sans-serif;
    background: #003D3C;
    color: white;
}

/* ===== HEADER ===== */
.header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 30px;
}

.logo {
    background: white;
    padding: 8px 14px;
    border-radius: 8px;
}
.logo img {
    height: 48px;
    display: block;
}

.center-title {
    font-size: 38px;
    font-weight: 800;
    letter-spacing: 1.5px;
    margin-left: 50px;
    color: #F7C227;
}

.datetime {
    font-size: 20px;
    font-weight: 600;
    white-space: nowrap;
}
.divider {
    color: #FFD966;
    margin: 0 8px;
}
.clock {
    color: #FFD966;
    margin-right: 4px;
}

/* GOLD LINE */
.gold-line {
    height: 6px;
    background: #F7C227;
}

/* ===== CONTENT ===== */
.content {
    background: #FFFFFF;
    color: #000;
    margin: 25px auto;
    width: 95%;
    max-width: 1300px;
    padding-bottom: 30px;
    border-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

.sub-title {
    text-align: center;
    font-size: 28px;
    font-weight: 800;
    padding: 20px 0 15px;
    color: #004787;
    border-bottom: 2px solid #EEEEEE;
    margin: 0 30px;
}

.last-update {
    text-align: center;
    font-size: 16px;
    color: #555;
    padding: 10px 0;
    font-style: italic;
}

/* TABLE */
table {
    width: 95%;
    margin: 20px auto 0;
    border-collapse: collapse;
    font-size: 20px;
    border: 3px solid #004787;
    border-radius: 16px;
    overflow: hidden;
}

th {
    background: #004787;
    color: white;
    padding: 14px;
    font-weight: 700;
    text-transform: uppercase;
}

td {
    padding: 14px;
    border-bottom: 1px solid #E0E0E0;
    font-weight: 600;
}

/* C·ªôt Lo·∫°i ti·ªÅn */
td:nth-child(1) {
    text-align: left;
    font-weight: 700;
    color: #333;
}

/* C·ªôt T√™n ngo·∫°i t·ªá */
td:nth-child(2) {
    text-align: left;
    color: #333;
}

/* C√°c c·ªôt s·ªë */
td:nth-child(n+3) {
    text-align: center;
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.5px;
}

/* D√≤ng xen k·∫Ω */
tr:nth-child(even) td {
    background: #F4F8FB;
}

/* FOOTER */
.footer {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    background: #003D3C;
    text-align: center;
    padding: 18px 20px;
    font-size: 18px;
    font-weight: 600;
    box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
}

.footer-gold {
    color: #FFD966;
    font-style: italic;
}

/* ===== RESPONSIVE CSS (Cho ƒêi·ªán tho·∫°i) ===== */
@media (max-width: 768px) {
    .header {
        flex-direction: column;
        padding: 15px 20px;
        align-items: center;
    }
    .center-title {
        font-size: 24px;
        margin: 10px 0;
        text-align: center;
        letter-spacing: 1px;
    }
    .datetime {
        font-size: 16px;
        margin-top: 5px;
    }
    
    .content {
        width: 98%;
        margin: 15px auto;
        padding-bottom: 20px;
    }
    
    .sub-title {
        font-size: 20px;
        padding: 15px 0 10px;
    }
    
    table {
        font-size: 14px;
        width: 98%;
    }
    
    th, td {
        padding: 10px 6px; /* Gi·∫£m padding cho √¥ */
    }

    /* Thu h·∫πp c·ªôt Lo·∫°i ti·ªÅn v√† T√™n ngo·∫°i t·ªá */
    td:nth-child(1), th:nth-child(1) { width: 10%; }
    td:nth-child(2), th:nth-child(2) { width: 30%; }
    
    .footer {
        font-size: 14px;
        padding: 15px 10px;
    }
}
/* END RESPONSIVE CSS */
</style>
</head>

<body>

<div class="header">
    <div class="logo">
        <img src="images/logo.png" alt="BIDV">
    </div>

    <div class="center-title">
        NG√ÇN H√ÄNG BIDV CHI NH√ÅNH TH√ÄNH VINH
    </div>

    <div class="datetime">
        <span id="date"></span>
        <span class="divider">|</span>
        <span class="clock">üïí</span>
        <span id="clock"></span>
    </div>
</div>

<div class="gold-line"></div>

<div class="content">
    <div class="sub-title">B·∫¢NG T·ª∂ GI√Å NGO·∫†I T·ªÜ</div>

    <div class="last-update">
        L·∫ßn c·∫≠p nh·∫≠t cu·ªëi:
        <span id="last-update-time"></span>
    </div>

    <table>
        <thead>
            <tr>
                <th>Lo·∫°i ti·ªÅn</th>
                <th>T√™n ngo·∫°i t·ªá</th>
                <th>Mua ti·ªÅn m·∫∑t</th>
                <th>Mua chuy·ªÉn kho·∫£n</th>
                <th>B√°n</th>
            </tr>
        </thead>
        <tbody id="exchange-rate-data">
            <tr><td colspan="5" style="text-align: center; font-style: italic;">ƒêang t·∫£i d·ªØ li·ªáu t·ª∑ gi√°...</td></tr>
        </tbody>
    </table>
</div>

<div class="footer">
    NG√ÇN H√ÄNG TMCP ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN VI·ªÜT NAM ‚Äì CHI NH√ÅNH TH√ÄNH VINH
    <span class="footer-gold"> ‚Äì H√ÇN H·∫†NH PH·ª§C V·ª§ QU√ù KH√ÅCH</span>
</div>

<script>
// =======================================================
// ** THI·∫æT L·∫¨P K·∫æT N·ªêI GOOGLE SHEET **
// =======================================================
// ID Google Sheet c·ªßa √îng Ch·ªß
const SHEET_ID = '16pWdQNd6UjUv4aTQLm2jCnhRR6QGjSR58yEwk9dYgdI'; 
// T√™n Sheet m·ªõi c·ªßa √îng Ch·ªß (ƒê√£ x√°c ƒë·ªãnh l√† 'data' ƒë·ªÉ tr√°nh l·ªói)
const SHEET_NAME = 'data'; 
const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;

// H√†m c·∫≠p nh·∫≠t th·ªùi gian hi·ªÉn th·ªã
function updateTime() {
    const now = new Date();
    const dateOptions = { weekday: 'long', day: '2-digit', month: '2-digit', year: 'numeric' };
    document.getElementById("date").innerHTML = now.toLocaleDateString('vi-VN', dateOptions);
    document.getElementById("clock").innerHTML = now.toLocaleTimeString('vi-VN');
}

// H√†m format gi√° tr·ªã: X·ª≠ l√Ω s·ªë, g·∫°ch ngang, √¥ tr·ªëng
function formatValue(cell) {
    if (!cell) {
        return ''; 
    }

    const formattedValue = cell.f; 
    const rawValue = cell.v;

    // N·∫øu gi√° tr·ªã c√≥ ƒë·ªãnh d·∫°ng (nh∆∞ d·∫•u g·∫°ch ngang '-') v√† kh√¥ng ph·∫£i l√† s·ªë
    if (formattedValue && isNaN(rawValue)) {
        return formattedValue;
    }

    // N·∫øu l√† s·ªë, format l·∫°i theo ƒë·ªãnh d·∫°ng Vi·ªát Nam
    if (typeof rawValue === 'number') {
        // S·ª≠ d·ª•ng minimumFractionDigits: 0 ƒë·ªÉ ƒë·∫£m b·∫£o s·ªë nguy√™n v·∫´n hi·ªÉn th·ªã ƒë·∫πp.
        return rawValue.toLocaleString('vi-VN', { minimumFractionDigits: 0, maximumFractionDigits: 4 }); 
    }
    
    // N·∫øu kh√¥ng c√≥ gi√° tr·ªã n√†o ƒë·∫∑c bi·ªát, tr·∫£ v·ªÅ r·ªóng
    return formattedValue || ''; 
}

// H√†m l·∫•y d·ªØ li·ªáu t·ª´ Google Sheets
async function fetchExchangeRates() {
    try {
        const response = await fetch(API_URL);
        const text = await response.text();
        
        // Tr√≠ch xu·∫•t chu·ªói JSON
        const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
        const data = JSON.parse(jsonText);
        
        const rows = data.table.rows;
        const tableBody = document.getElementById('exchange-rate-data');
        
        let newRows = '';

        // *** QUAN TR·ªåNG: D√ôNG .slice(1) ƒê·ªÇ B·ªé QUA H√ÄNG TI√äU ƒê·ªÄ (H√†ng 1) ***
        rows.slice(1).forEach(row => { 
            // L·∫•y d·ªØ li·ªáu t·ª´ 5 c·ªôt: c[0] -> c[4]
            const currencyCode = row.c[0] ? row.c[0].v : '';
            const currencyName = row.c[1] ? row.c[1].v : '';
            
            // X·ª≠ l√Ω c√°c c·ªôt t·ª∑ gi√° b·∫±ng h√†m formatValue
            const cashBuy = formatValue(row.c[2]);
            const transferBuy = formatValue(row.c[3]);
            const sell = formatValue(row.c[4]);

            if (currencyCode) { // Ch·ªâ th√™m d√≤ng n·∫øu c√≥ Lo·∫°i ti·ªÅn
                 newRows += `
                    <tr>
                        <td>${currencyCode}</td>
                        <td>${currencyName}</td>
                        <td>${cashBuy}</td>
                        <td>${transferBuy}</td>
                        <td>${sell}</td>
                    </tr>`;
            }
        });
        
        // Thay th·∫ø n·ªôi dung c≈© trong tbody b·∫±ng d·ªØ li·ªáu m·ªõi
        tableBody.innerHTML = newRows;
        
        // C·∫≠p nh·∫≠t "L·∫ßn c·∫≠p nh·∫≠t cu·ªëi"
        const now = new Date();
        document.getElementById("last-update-time").innerHTML = 
            now.toLocaleTimeString('vi-VN') + ' - ' + now.toLocaleDateString('vi-VN');

    } catch (error) {
        console.error('L·ªói khi t·∫£i t·ª∑ gi√°:', error);
        document.getElementById('exchange-rate-data').innerHTML = 
            '<tr><td colspan="5" style="text-align: center; color: red; font-weight: bold;">Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª∑ gi√°. Vui l√≤ng ki·ªÉm tra Google Sheet ID, T√™n Sheet v√† quy·ªÅn chia s·∫ª.</td></tr>';
    }
}


// --- Kh·ªüi t·∫°o ---
// 1. C·∫≠p nh·∫≠t ƒë·ªìng h·ªì m·ªói gi√¢y
setInterval(updateTime, 1000); 
updateTime(); 

// 2. T·∫£i t·ª∑ gi√° l·∫ßn ƒë·∫ßu v√† sau m·ªói 5 ph√∫t (300000 ms)
fetchExchangeRates(); 
setInterval(fetchExchangeRates, 300000); 
</script>

</body>
</html>